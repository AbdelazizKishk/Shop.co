<section>
  <div class="container mx-auto h-full my-4">
    <div class="flex justify-center items-center h-full">
      <div class="w-full lg:w-11/12 xl:w-11/12">
        <div class="bg-white text-black rounded-2xl shadow-md">
          <div class="p-6 md:p-8">
            <div class="flex flex-col lg:flex-row justify-center">
              <div
                class="w-full md:w-10/12 lg:w-6/12 xl:w-5/12 order-2 lg:order-1"
              >
                <p
                  class="text-center text-3xl font-bold mb-3 mx-1 md:mx-4 mt-2"
                >
                  Checkout
                </p>

                <form
                  [formGroup]="checkoutForm"
                  (ngSubmit)="onSubmit()"
                  class="mx-1 md:mx-4"
                >
                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let detailsControl = checkoutForm.get('details');
                      <label class="block mb-1 font-semibold" for="details"
                        >Your Details</label
                      >
                      <textarea
                        [ngClass]="{
                          'border-red-500':
                            detailsControl?.errors && detailsControl?.touched,
                          'border-green-500': !detailsControl?.errors
                        }"
                        type="text"
                        formControlName="details"
                        id="details"
                        class="w-full border rounded p-2 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                      >
                      </textarea>

                      @if (detailsControl?.errors && detailsControl?.touched) {
                      <div
                        class="bg-red-100 text-red-700 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (detailsControl?.getError('required')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>details is required</small>
                        </div>
                        } @else if (detailsControl?.getError('minlength')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>details must be at least 10 characters</small>
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>

                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let phoneControl = checkoutForm.get('phone');
                      <label class="block mb-1 font-semibold" for="Phone"
                        >Your Phone</label
                      >
                      <div class="relative mb-0">
                        <div
                          class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
                        >
                          <i class="fas fa-phone fa-lg mr-3"></i>
                        </div>
                        <input
                          [ngClass]="{
                            'border-red-500':
                              phoneControl?.errors && phoneControl?.touched,
                            'border-green-500': !phoneControl?.errors
                          }"
                          type="tel"
                          formControlName="phone"
                          id="Phone"
                          class="w-full border rounded ps-10 p-2 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                        />
                      </div>

                      @if (phoneControl?.errors && phoneControl?.touched) {
                      <div
                        class="bg-red-100 text-red-700 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (phoneControl?.getError('required')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Phone is required</small>
                        </div>
                        } @else if (phoneControl?.getError('pattern')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Must be an Egyptian phone number</small>
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>

                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let cityControl = checkoutForm.get('city');
                      <label class="block mb-1 font-semibold" for="city"
                        >Your City</label
                      >
                      <div class="relative mb-0">
                        <div
                          class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
                        >
                          <i class="fas fa-city fa-lg mr-3"></i>
                        </div>
                        <input
                          [ngClass]="{
                            'border-red-500':
                              cityControl?.errors && cityControl?.touched,
                            'border-green-500': !cityControl?.errors
                          }"
                          type="text"
                          formControlName="city"
                          id="city"
                          class="w-full border rounded ps-10 p-2 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                        />
                      </div>

                      @if (cityControl?.errors && cityControl?.touched) {
                      <div
                        class="bg-red-100 text-red-700 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (cityControl?.getError('required')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>city is required</small>
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>

                  <div class="flex items-center mb-4">
                    <input type="checkbox" class="mr-2" id="form2Example3c" />
                    <label for="form2Example3" class="text-sm">
                      I agree to all statements in
                      <a href="#!" class="text-blue-600 underline"
                        >Terms of Service</a
                      >
                    </label>
                  </div>

                  <div class="mb-3">
                    <button
                      [disabled]="checkoutForm.invalid"
                      type="submit"
                      class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 disabled:bg-slate-700 transition"
                    >
                      Next @if (isLoading) {
                      <span><i class="fas fa-spin fa-spinner"></i></span>
                      }
                    </button>
                  </div>
                  @if (scucessMsg) {
                  <div
                    class="bg-green-100 text-green-700 text-center capitalize w-3/4 mx-auto py-2 px-4 rounded mb-4"
                    role="alert"
                  >
                    ðŸŽ‰ Success! You can checkout now
                  </div>
                  }
                </form>
              </div>

              <div
                class="w-full md:w-10/12 lg:w-7/12 xl:w-6/12 flex items-center order-1 lg:order-2"
              >
                <img
                  src="/images/imageDesign/checkout.svg"
                  class="w-full"
                  alt="Sample image"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
