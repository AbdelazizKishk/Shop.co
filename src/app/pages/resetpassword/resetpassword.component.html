<section>
  <div class="container mx-auto h-full my-16">
    <div class="flex justify-center items-center h-full">
      <div class="w-full lg:w-11/12 xl:w-11/12">
        <div class="bg-white text-black rounded-2xl shadow-md">
          <div class="p-6 md:p-8">
            <div class="flex flex-col lg:flex-row justify-center items-center">
              <div
                class="w-full md:w-10/12 lg:w-6/12 xl:w-5/12 order-2 lg:order-1"
              >
                <p
                  class="text-center text-3xl font-bold mb-3 mx-1 md:mx-4 mt-2"
                >
                  Forget Password
                </p>

                @if (step === 1) {
                <form
                  [formGroup]="verfiyEmailForm"
                  (ngSubmit)="onSubmitEmail()"
                  class="mx-1 md:mx-4"
                >
                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let emailControl = verfiyEmailForm.get('email');
                      <label class="block mb-1 font-semibold" for="email"
                        >Your Email</label
                      >
                      <div class="relative mb-0">
                        <div
                          class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
                        >
                          <i class="fas fa-envelope fa-lg mr-3"></i>
                        </div>
                        <input
                          type="email"
                          formControlName="email"
                          id="email"
                          placeholder="name@flowbite.com"
                          class="w-full border rounded ps-10 p-2 placeholder-gray-400 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                        />
                      </div>
                      @if (emailControl?.errors && emailControl?.touched) {
                      <div
                        class="bg-red-100 text-red-700 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (emailControl?.getError('required')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Email is required</small>
                        </div>
                        } @else if (emailControl?.getError('email')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Enter a valid Email</small>
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>
                  <div class="mb-3">
                    <button
                      [disabled]="verfiyEmailForm.invalid"
                      type="submit"
                      class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 disabled:bg-slate-700 transition"
                    >
                      Next @if (isLoading) {
                      <span><i class="fas fa-spin fa-spinner"></i></span>
                      }
                    </button>
                  </div>
                </form>
                } @else if (step === 2) {
                <form
                  [formGroup]="verfiyCodeForm"
                  (ngSubmit)="onSubmitCode()"
                  class="mx-1 md:mx-4"
                >
                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let resetCodeControl = verfiyCodeForm.get('resetCode');
                      <label class="block mb-1 font-semibold" for="resetCode"
                        >Your Code</label
                      >
                      <div class="relative mb-0">
                        <div
                          class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
                        >
                          <i class="fas fa-envelope fa-lg mr-3"></i>
                        </div>
                        <input
                          type="text"
                          formControlName="resetCode"
                          id="resetCode"
                          placeholder="123456"
                          class="w-full border rounded ps-10 p-2 placeholder-gray-400 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                        />
                      </div>
                      @if (resetCodeControl?.errors &&
                      resetCodeControl?.touched) {
                      <div
                        class="bg-red-100 text-red-700 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (resetCodeControl?.getError('required')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Code is required</small>
                        </div>
                        } @else if (resetCodeControl?.getError('pattern')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Code must be 6 characters</small>
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>
                  <div class="mb-3">
                    <button
                      [disabled]="verfiyCodeForm.invalid"
                      type="submit"
                      class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 disabled:bg-slate-700 transition"
                    >
                      Next @if (isLoading) {
                      <span><i class="fas fa-spin fa-spinner"></i></span>
                      }
                    </button>
                  </div>
                </form>
                } @else if (step === 3) {
                <form
                  [formGroup]="verfiyNewpassForm"
                  (ngSubmit)="onSubmitNewPassword()"
                  class="mx-1 md:mx-4"
                >
                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let emailControll = verfiyNewpassForm.get('email');
                      <label class="block mb-1 font-semibold" for="email"
                        >Your Email</label
                      >
                      <div class="relative mb-0">
                        <div
                          class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
                        >
                          <i class="fas fa-envelope fa-lg mr-3"></i>
                        </div>
                        <input
                          type="email"
                          formControlName="email"
                          id="email"
                          readonly
                          placeholder="name@flowbite.com"
                          class="w-full border rounded ps-10 p-2 placeholder-gray-400 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                        />
                      </div>
                      @if (emailControll?.errors && emailControll?.touched) {
                      <div
                        class="bg-red-100 text-red-700 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (emailControll?.getError('required')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Email is required</small>
                        </div>
                        } @else if (emailControll?.getError('email')) {
                        <div class="mt-1 text-red-600 text-sm">
                          <small>Enter a valid Email</small>
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>

                  <div class="flex items-center mb-4">
                    <div class="flex-grow mb-0">
                      @let newPasswordControl =
                      verfiyNewpassForm.get('newPassword');
                      <label class="block mb-1 font-semibold" for="newPassword"
                        >New Password</label
                      >
                      <div class="relative mb-0">
                        <div
                          class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
                        >
                          <i class="fas fa-lock fa-lg mr-3"></i>
                        </div>

                        <input
                          type="password"
                          formControlName="newPassword"
                          id="newPassword"
                          class="w-full border rounded ps-10 p-2 focus:outline-none focus:border-none focus:ring-2 focus:ring-blue-500"
                        />
                      </div>

                      @if (newPasswordControl?.errors &&
                      newPasswordControl?.touched) {
                      <div
                        class="bg-red-100 text-red-600 p-2 mt-2 rounded"
                        role="alert"
                      >
                        @if (newPasswordControl?.invalid &&
                        newPasswordControl?.touched) {
                        <div class="mt-1 text-red-600 text-sm space-y-1">
                          @if (newPasswordControl?.errors?.['required']) {
                          <small>newPassword is required.</small>
                          } @if (newPasswordControl?.errors?.['minlength']) {
                          <small
                            >newPassword must be at least 6 characters
                            long.</small
                          >
                          }
                        </div>
                        }
                      </div>
                      }
                    </div>
                  </div>

                  <div class="mb-3">
                    <button
                      [disabled]="verfiyNewpassForm.invalid"
                      type="submit"
                      class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 disabled:bg-slate-700 transition"
                    >
                      Next @if (isLoading) {
                      <span><i class="fas fa-spin fa-spinner"></i></span>
                      }
                    </button>
                  </div>
                </form>
                }
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
